<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.89.4" />
    <meta name="description" content="Open Search Log Analytics Workshop">
<meta name="author" content="Chris Sharkey">

    <link rel="icon" href="../images/favicon.png" type="image/png">

    <title>2. Environment Set Up :: Open Search Log Analytics Workshop</title>

    
    <link href="../css/nucleus.css" rel="stylesheet">
    <link href="../css/fontawesome-all.min.css" rel="stylesheet">
    <link href="../css/hybrid.css" rel="stylesheet">
    <link href="../css/featherlight.min.css" rel="stylesheet">
    <link href="../css/perfect-scrollbar.min.css" rel="stylesheet">
    <link href="../css/auto-complete.css" rel="stylesheet">
    <link href="../css/atom-one-dark-reasonable.css" rel="stylesheet">
    <link href="../css/theme.css" rel="stylesheet">
    <link href="../css/hugo-theme.css" rel="stylesheet">
    
    <link href="../css/theme-aws.css" rel="stylesheet">
    
    

    <script src="../js/jquery-3.3.1.min.js"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="../collect-log-cloud-watch/2_environment_set_up.html">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <div id="logo">
  <img stlye="vertical-align:middle" src="https://sharkech-public.s3.amazonaws.com/misc-public/aws_logo.png" height="70px">
</div>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="../js/lunr.min.js"></script>
<script type="text/javascript" src="../js/auto-complete.js"></script>
<script type="text/javascript">
    
        var baseurl = "";
    
</script>
<script type="text/javascript" src="../js/search.js"></script>

    
  </div>
  
    <section id="homelinks">
      <ul>
        <li>
            <a class="padding" href='../index.html'><i class='fas fa-home'></i> Home</a>
        </li>
      </ul>
    </section>
  

    <div class="highlightable">
    <ul class="topics">
        
          
          




 
  
    
    <li data-nav-id="/open-search-log-analytics/" title="1. OpenSearch Log Analytics" class="dd-item
        
        
        
        ">
      <a href="../open-search-log-analytics/index.html">
          OpenSearch Log Analytics
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/open-search-log-analytics/1_getting_started.html" title="1. Getting started" class="dd-item
        
        
        
        ">
      <a href="../open-search-log-analytics/1_getting_started.html">
          Getting Started
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/open-search-log-analytics/1_getting_started/aws_event.html" title="AWS Event" class="dd-item ">
        <a href="../open-search-log-analytics/1_getting_started/aws_event.html">
        AWS Event
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/open-search-log-analytics/1_getting_started/self_paced.html" title="Self Paced" class="dd-item ">
        <a href="../open-search-log-analytics/1_getting_started/self_paced.html">
        Self Paced
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/open-search-log-analytics/2_environment_set_up.html" title="2. Environment Set Up" class="dd-item
        
        
        
        ">
      <a href="../open-search-log-analytics/2_environment_set_up.html">
          Environment Set Up
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/open-search-log-analytics/2_environment_set_up/cloudformation_automated.html" title="CloudFormation (Automated)" class="dd-item ">
        <a href="../open-search-log-analytics/2_environment_set_up/cloudformation_automated.html">
        CloudFormation (Automated)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/open-search-log-analytics/2_environment_set_up/console_manual.html" title="Console Deploy (Manual)" class="dd-item ">
        <a href="../open-search-log-analytics/2_environment_set_up/console_manual.html">
        Console Deploy (Manual)
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/open-search-log-analytics/3_send_log_data_to_kinesis_fire_hose.html" title="3. Send Log Data to Kinesis Firehose" class="dd-item
        
        
        
        ">
      <a href="../open-search-log-analytics/3_send_log_data_to_kinesis_fire_hose.html">
          Send Log Data to Kinesis Firehose
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/open-search-log-analytics/4_visualize_analyze.html" title="4. Visualize and Analyze" class="dd-item
        
        
        
        ">
      <a href="../open-search-log-analytics/4_visualize_analyze.html">
          Visualize and Analyze
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/open-search-log-analytics/5_clean_up.html" title="5. Clean Up" class="dd-item
        
        
        
        ">
      <a href="../open-search-log-analytics/5_clean_up.html">
          Clean Up
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/collect-log-cloud-watch/" title="2. CloudWatch Log Collection" class="dd-item
        parent
        
        
        ">
      <a href="../collect-log-cloud-watch/index.html">
          CloudWatch Log Collection
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/collect-log-cloud-watch/1_getting_started.html" title="1. Getting started" class="dd-item
        
        
        
        ">
      <a href="../collect-log-cloud-watch/1_getting_started.html">
          Getting started
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/collect-log-cloud-watch/1_getting_started/aws_event.html" title="AWS Event" class="dd-item ">
        <a href="../collect-log-cloud-watch/1_getting_started/aws_event.html">
        AWS Event
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/collect-log-cloud-watch/1_getting_started/self_paced.html" title="Self Paced" class="dd-item ">
        <a href="../collect-log-cloud-watch/1_getting_started/self_paced.html">
        Self Paced
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/collect-log-cloud-watch/2_environment_set_up.html" title="2. Environment Set Up" class="dd-item
        parent
        active
        
        ">
      <a href="../collect-log-cloud-watch/2_environment_set_up.html">
          Environment Set Up
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/collect-log-cloud-watch/3_send_log_data_to_opensearch.html" title="3. Send Log Data to OpenSearch" class="dd-item
        
        
        
        ">
      <a href="../collect-log-cloud-watch/3_send_log_data_to_opensearch.html">
          Send Log Data to OpenSearch
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/collect-log-cloud-watch/4_search_logs.html" title="4. Search Logs" class="dd-item
        
        
        
        ">
      <a href="../collect-log-cloud-watch/4_search_logs.html">
          Search Logs
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/collect-log-cloud-watch/5_clean_up.html" title="5. Clean Up" class="dd-item
        
        
        
        ">
      <a href="../collect-log-cloud-watch/5_clean_up.html">
          Clean Up
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/open-search-fluentd/" title="3. Fluntd Log Ingestion" class="dd-item
        
        
        
        ">
      <a href="../open-search-fluentd/index.html">
          Fluentd Log Ingestion
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/open-search-fluentd/1_getting_started.html" title="1. Getting Started" class="dd-item
        
        
        
        ">
      <a href="../open-search-fluentd/1_getting_started.html">
          Getting Started
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/open-search-fluentd/1_getting_started/aws_event.html" title="AWS Event" class="dd-item ">
        <a href="../open-search-fluentd/1_getting_started/aws_event.html">
        AWS Event
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/open-search-fluentd/1_getting_started/self_paced.html" title="Self Paced" class="dd-item ">
        <a href="../open-search-fluentd/1_getting_started/self_paced.html">
        Self Paced
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/open-search-fluentd/2_environment_set_up.html" title="2. Environment Set Up" class="dd-item
        
        
        
        ">
      <a href="../open-search-fluentd/2_environment_set_up.html">
          Environment Set Up
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/open-search-fluentd/2_environment_set_up/cloudformation_automated.html" title="CloudFormation (Automated)" class="dd-item ">
        <a href="../open-search-fluentd/2_environment_set_up/cloudformation_automated.html">
        CloudFormation (Automated)
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/open-search-fluentd/3_configure_fluentd.html" title="3. Configure Fluentd" class="dd-item
        
        
        
        ">
      <a href="../open-search-fluentd/3_configure_fluentd.html">
          Configure Fluentd
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/open-search-fluentd/4_search_logs.html" title="4. Search Logs" class="dd-item
        
        
        
        ">
      <a href="../open-search-fluentd/4_search_logs.html">
          Search Logs
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/open-search-fluentd/5_clean_up.html" title="5. Clean Up" class="dd-item
        
        
        
        ">
      <a href="../open-search-fluentd/5_clean_up.html">
          Clean Up
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/anomaly-detection-w-msk/" title="4. Anomaly Detection with MSK" class="dd-item
        
        
        
        ">
      <a href="../anomaly-detection-w-msk/index.html">
          Anomaly Detection with MSK
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/anomaly-detection-w-msk/1_getting_started.html" title="1. Getting Started" class="dd-item
        
        
        
        ">
      <a href="../anomaly-detection-w-msk/1_getting_started.html">
          Getting Started
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/anomaly-detection-w-msk/1_getting_started/aws_event.html" title="AWS Event" class="dd-item ">
        <a href="../anomaly-detection-w-msk/1_getting_started/aws_event.html">
        AWS Event
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/anomaly-detection-w-msk/1_getting_started/self_paced.html" title="Self Paced" class="dd-item ">
        <a href="../anomaly-detection-w-msk/1_getting_started/self_paced.html">
        Self Paced
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/anomaly-detection-w-msk/2_environment_set_up.html" title="2. Environment Set Up" class="dd-item
        
        
        
        ">
      <a href="../anomaly-detection-w-msk/2_environment_set_up.html">
          Environment Set Up
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/anomaly-detection-w-msk/2_environment_set_up/cloudformation_automated.html" title="CloudFormation (Automated)" class="dd-item ">
        <a href="../anomaly-detection-w-msk/2_environment_set_up/cloudformation_automated.html">
        CloudFormation (Automated)
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/anomaly-detection-w-msk/3_configure_lambda.html" title="3. Configure Lambda" class="dd-item
        
        
        
        ">
      <a href="../anomaly-detection-w-msk/3_configure_lambda.html">
          Configure Lambda
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/anomaly-detection-w-msk/4_send_logs.html" title="4. Send Logs" class="dd-item
        
        
        
        ">
      <a href="../anomaly-detection-w-msk/4_send_logs.html">
          Send Logs
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/anomaly-detection-w-msk/5_anomaly_detection.html" title="5. Anomaly Detection" class="dd-item
        
        
        
        ">
      <a href="../anomaly-detection-w-msk/5_anomaly_detection.html">
          Anomaly Detection
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/anomaly-detection-w-msk/6_clean_up.html" title="6. Clean Up" class="dd-item
        
        
        
        ">
      <a href="../anomaly-detection-w-msk/6_clean_up.html">
          Clean Up
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/open-search-cross-cluster-replication/" title="Cross Cluster Replication" class="dd-item
        
        
        
        ">
      <a href="../open-search-cross-cluster-replication/">
          Cross Cluster Replication
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/open-search-cross-cluster-replication/1_getting_started.html" title="1. Getting started" class="dd-item
        
        
        
        ">
      <a href="../open-search-cross-cluster-replication/1_getting_started.html">
          Getting Started
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/open-search-cross-cluster-replication/1_getting_started/aws_event.html" title="AWS Event" class="dd-item ">
        <a href="../open-search-cross-cluster-replication/1_getting_started/aws_event.html">
        AWS Event
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/open-search-cross-cluster-replication/1_getting_started/self_paced.html" title="Self Paced" class="dd-item ">
        <a href="../open-search-cross-cluster-replication/1_getting_started/self_paced.html">
        Self Paced
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/open-search-cross-cluster-replication/2_environment_set_up.html" title="2. Environment Set Up" class="dd-item
        
        
        
        ">
      <a href="../open-search-cross-cluster-replication/2_environment_set_up.html">
          Environment Set Up
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/open-search-cross-cluster-replication/2_environment_set_up/cloudformation_automated.html" title="CloudFormation" class="dd-item ">
        <a href="../open-search-cross-cluster-replication/2_environment_set_up/cloudformation_automated.html">
        CloudFormation
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/open-search-cross-cluster-replication/3_setup_connection.html" title="3. Setup Cross-Cluster Connection" class="dd-item
        
        
        
        ">
      <a href="../open-search-cross-cluster-replication/3_setup_connection.html">
          Setup Cross-Cluster Connection
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/open-search-cross-cluster-replication/4_test_replication.html" title="4. Test Replication" class="dd-item
        
        
        
        ">
      <a href="../open-search-cross-cluster-replication/4_test_replication.html">
          Test Replication
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/open-search-cross-cluster-replication/5_clean_up.html" title="5. Clean Up" class="dd-item
        
        
        
        ">
      <a href="../open-search-cross-cluster-replication/5_clean_up.html">
          Clean Up
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/open-search-alerting/" title="OpenSearch Alerting" class="dd-item
        
        
        
        ">
      <a href="../open-search-alerting/index.html">
          OpenSearch Alerting
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/open-search-alerting/1_getting_started.html" title="1. Getting started" class="dd-item
        
        
        
        ">
      <a href="../open-search-alerting/1_getting_started.html">
          Getting Started
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/open-search-alerting/1_getting_started/aws_event.html" title="AWS Event" class="dd-item ">
        <a href="../open-search-alerting/1_getting_started/aws_event.html">
        AWS Event
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/open-search-alerting/1_getting_started/self_paced.html" title="Self Paced" class="dd-item ">
        <a href="../open-search-alerting/1_getting_started/self_paced.html">
        Self Paced
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/open-search-alerting/2_environment_set_up.html" title="2. Environment Set Up" class="dd-item
        
        
        
        ">
      <a href="../open-search-alerting/2_environment_set_up.html">
          Environment Set Up
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/open-search-alerting/2_environment_set_up/cloudformation_automated.html" title="CloudFormation" class="dd-item ">
        <a href="../open-search-alerting/2_environment_set_up/cloudformation_automated.html">
        CloudFormation
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/open-search-alerting/2_environment_set_up/create_index.html" title="Create OpenSearch Index" class="dd-item ">
        <a href="../open-search-alerting/2_environment_set_up/create_index.html">
        Create OpenSearch Index
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/open-search-alerting/3_create_alert.html" title="3. Create Alert" class="dd-item
        
        
        
        ">
      <a href="../open-search-alerting/3_create_alert.html">
          Create Alert
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/open-search-alerting/4_trigger_alert.html" title="4. Trigger Alert" class="dd-item
        
        
        
        ">
      <a href="../open-search-alerting/4_trigger_alert.html">
          Trigger Alert
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/open-search-alerting/5_clean_up.html" title="5. Clean Up" class="dd-item
        
        
        
        ">
      <a href="../open-search-alerting/5_clean_up.html">
          Clean Up
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3></h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://github.com/ev2900/OpenSearch_Log_Analytics/"><i class='fab fa-github'></i> GitHub Project</a>
              </li>
          
              <li>
                  <a class="padding" href="mailto:sharkech@amazon.com"><i class='fas fa-envelope'></i> Have questions?</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>
<div style="height:25px">
  
</div>
    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link"></div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='../'>OpenSearch Log Analytics Workshop</a> > <a href='../collect-log-cloud-watch/index.html'>CloudWatch Log Collection</a> > Environment Set Up
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              2. Environment Set Up
            </h1>
          

        



	<p>We need to deploy a few services and configure our AWS environment before we can get started.</p>
<p>We will need to complete the following set up steps</p>
<ol>
<li>Create an OpenSearch Domain</li>
<li>Create an IAM Role</li>
<li>Map IAM Role to OpenSearch Role</li>
<li>Deploy Glue Jobs to Generate CloudWatch Logs</li>
</ol>
<p>Follow the instructions below for each step</p>
<h4 id="create-an-opensearch-domain">Create an OpenSearch Domain</h4>
<ol>
<li>Go to the <a href="https://console.aws.amazon.com/esv3/home">OpenSearch Console</a></li>
<li>Click on <strong>Create domain</strong></li>
</ol>
<p><img src="../images/open-search-log-analytics/set_up_1.PNG" alt="cloud_shell_button"></p>
<ol start="3">
<li>Enter the name <code>workshop-domain</code> for the OpenSearch Domain</li>
<li>Under the deployment type section, select <code>Development and testing</code></li>
<li>Under the network section, select <code>Public access</code></li>
<li>Under the fine-grained access control section select <code>Create master user</code></li>
<li>Enter and username and password. Copy down the user name and password. We will need these later in the workshop</li>
<li>Leave all other settings at the default selections</li>
<li>Click on <strong>Create</strong></li>
</ol>
<p>It will take approximately 5 - 10 minutes for your OpenSearch domain to be created. Upon successful creation you will see your OpenSearch domain status is active</p>
<p><img src="../images/open-search-log-analytics/set_up_2.PNG" alt="cloud_shell_button"></p>
<p>Do not proceed to the next step until you confirm that your domain status is active</p>
<h4 id="create-an-iam-role">Create an IAM Role</h4>
<ol>
<li>Go to the <a href="https://console.aws.amazon.com/iamv2/home">IAM Console</a></li>
<li>Click on <strong>Roles</strong></li>
</ol>
<p><img src="../images/collect-log-cloud-watch/CONFIG_IAM_1.PNG" alt="ONFIG_IAM_1"></p>
<ol start="3">
<li>Click on <strong>Create role</strong></li>
</ol>
<p><img src="../images/collect-log-cloud-watch/CONFIG_IAM_2.PNG" alt="CONFIG_IAM_2"></p>
<ol start="4">
<li>Under the choose a use case click on <strong>Lambda</strong> and then click on <strong>Next:Permissions</strong></li>
</ol>
<p><img src="../images/collect-log-cloud-watch/CONFIG_IAM_3.PNG" alt="CONFIG_IAM_3"></p>
<ol start="5">
<li>Search for <code>AdministratorAccess</code> and click on the box next to the AdministratorAccess policies</li>
</ol>
<p><strong>Note</strong> for the purposes of this workshop we will give the IAM role AdministratorAccess. In a production environment you should scope down the permissions given to the IAM role</p>
<p><img src="../images/collect-log-cloud-watch/CONFIG_IAM_4.PNG" alt="CONFIG_IAM_4"></p>
<ol start="6">
<li>Click on <strong>Next: Tags</strong></li>
<li>Click on <strong>Next: Review</strong> . There is no need to change anything on the Add tags page</li>
<li>Name the role <code>workshop-role</code></li>
<li>Click on <strong>Create role</strong></li>
</ol>
<p><img src="../images/collect-log-cloud-watch/CONFIG_IAM_5.PNG" alt="CONFIG_IAM_5"></p>
<ol start="10">
<li>Back on the <a href="https://console.aws.amazon.com/iamv2/home#/roles">IAM Roles page</a> search for and select the <code>workshop-role</code> you just created</li>
</ol>
<p><img src="../images/collect-log-cloud-watch/CONFIG_IAM_6.PNG" alt="CONFIG_IAM_6"></p>
<ol start="11">
<li>On the summary page copy down the Role ARN. We will need this later in the workshop</li>
</ol>
<p><img src="../images/collect-log-cloud-watch/CONFIG_IAM_7.PNG" alt="CONFIG_IAM_7"></p>
<ol start="12">
<li>Click on the <strong>Trust relationships</strong> tab</li>
<li>Click on the <strong>Edit trust relationship</strong></li>
</ol>
<p><img src="../images/collect-log-cloud-watch/CONFIG_IAM_9.PNG" alt="CONFIG_IAM_9"></p>
<ol start="14">
<li>Replace the service section of the JSON with the following</li>
</ol>
<pre tabindex="0"><code>&quot;Service&quot;: [
	&quot;lambda.amazonaws.com&quot;,
	&quot;glue.amazonaws.com&quot;
]
</code></pre><p>Your trust relationship policy document should look like the following</p>
<p><img src="../images/collect-log-cloud-watch/CONFIG_IAM_10.PNG" alt="CONFIG_IAM_10"></p>
<ol start="15">
<li>Click on <strong>Update Trust Policy</strong></li>
</ol>
<h4 id="map-iam-role-to-opensearch-role">Map IAM Role to OpenSearch Role</h4>
<ol>
<li>Go to the <a href="https://console.aws.amazon.com/esv3/home">OpenSearch Console</a></li>
<li>Click on the <strong>workshop-domain</strong> OpenSearch domain you created earlier</li>
<li>Click on the OpenSearch Dashboard URL. This should open the URL in a web browser window</li>
</ol>
<p><img src="../images/open-search-log-analytics/IAM_4.PNG" alt="open_search_dashboard"></p>
<ol start="4">
<li>You will be prompted to log in. Using the user name and password you created during the OpenSearch deployment, log in</li>
<li>If an additional pop up window is present after login asking about data upload click on <strong>Explore on my own</strong></li>
<li>If an additional pop up windows is present asking you to select your tenant select <strong>Global</strong> and click on <strong>Confirm</strong></li>
</ol>
<p>You should now see a window that looks like this</p>
<p><img src="../images/open-search-log-analytics/os_1.PNG" alt="select_domain"></p>
<ol start="7">
<li>Click on and expand the hamburger menu on the side bar of the OpenSearch home page</li>
<li>Under the OpenSearch Plugins section click on <strong>Security</strong></li>
</ol>
<p><img src="../images/open-search-log-analytics/os_2.PNG" alt="select_security"></p>
<ol start="9">
<li>On the security page click on <strong>Roles</strong> from the left hand menu</li>
</ol>
<p><img src="../images/open-search-log-analytics/os_3.PNG" alt="select_roles"></p>
<ol start="10">
<li>On the roles page search for and click on <code>all_access</code></li>
</ol>
<p><img src="../images/open-search-log-analytics/os_4.PNG" alt="search_all_access"></p>
<ol start="11">
<li>On the all_access role page click on <strong>Mapped users</strong></li>
<li>Under the mapped users page click on <strong>Manage mapping</strong></li>
</ol>
<p><img src="../images/open-search-log-analytics/os_5.PNG" alt="mapped_users"></p>
<ol start="13">
<li>Under the backend roles section enter the ARN that you copied down earlier for the IAM workshop-role that you created</li>
<li>Click on <strong>Map</strong></li>
</ol>
<p><img src="../images/collect-log-cloud-watch/CONFIG_IAM_8.PNG" alt="CONFIG_IAM_8"></p>
<h4 id="deploy-glue-jobs-to-generate-cloudwatch-logs">Deploy Glue Jobs to Generate CloudWatch Logs</h4>
<p>CloudWatch provides log collection for AWS services. In order to generate logs that we can use in this workshop we will create two simple AWS Glue Jobs. We can run these jobs to produce logs. Subsequently we can analyze these logs in OpenSearch</p>
<ol>
<li>Go to the <a href="https://console.aws.amazon.com/glue/home">Glue Console</a></li>
<li>On the left hand menu click on <strong>Jobs</strong></li>
</ol>
<p><img src="../images/collect-log-cloud-watch/GLUE_1.PNG" alt="GLUE_1"></p>
<ol start="3">
<li>On the jobs page click on <strong>Add job</strong></li>
</ol>
<p><img src="../images/collect-log-cloud-watch/GLUE_2.PNG" alt="GLUE_2"></p>
<ol start="4">
<li>Enter <code>glue_job_success</code> for the name of the job</li>
<li>For the IAM tole select <strong>workshop-role</strong></li>
<li>Under the this job run section select <strong>A new script to be authored by you</strong></li>
</ol>
<p><img src="../images/collect-log-cloud-watch/GLUE_3.PNG" alt="GLUE_3"></p>
<ol start="7">
<li>Under the monitoring options click on <strong>Job metrics</strong> and <strong>Continuous logging</strong></li>
</ol>
<p><img src="../images/collect-log-cloud-watch/GLUE_4.PNG" alt="GLUE_4"></p>
<ol start="8">
<li>Under the security configuration, script libraries, and job parameters (optional) set the max concurrency to <code>10</code></li>
</ol>
<p><img src="../images/collect-log-cloud-watch/GLUE_7.PNG" alt="GLUE_7"></p>
<ol start="9">
<li>
<p>Leave all other settings at the default selections and click on <strong>Next</strong> at the bottom of the page</p>
</li>
<li>
<p>On the connections page leave all of the setting at the defaults and click on <strong>Save job and edit script</strong></p>
</li>
</ol>
<p><img src="../images/collect-log-cloud-watch/GLUE_5.PNG" alt="GLUE_4"></p>
<ol start="11">
<li>In the edit job window copy and paste the following code into the editing window</li>
</ol>
<pre tabindex="0"><code>from awsglue.context import GlueContext
from pyspark.context import SparkContext

sc = SparkContext()
glueContext = GlueContext(sc)

logger = glueContext.get_logger()

logger.error(&quot;Success!!&quot;)
</code></pre><p><img src="../images/collect-log-cloud-watch/GLUE_6.PNG" alt="GLUE_4"></p>
<ol start="12">
<li>Click on <strong>Save</strong></li>
<li>Click on <strong>Run</strong></li>
<li>Repeat steps 1 - 13 again. However this time name the Glue job <code>glue_job_error</code> and use the following code in the job</li>
</ol>
<pre tabindex="0"><code>from awsglue.context import GlueContext
from pyspark.context import SparkContext

sc = SparkContext()
glueContext = GlueContext(sc)

logger = glueContext.get_logger()

logger.error(&quot;Error!!&quot;)
</code></pre><p>The jobs will use the logger in AWS Glue to produce custom error log message <em>Success!!</em> and <em>Error!!</em>. Later in this workshop we will search for the log message in OpenSearch.</p>
<p>You have completed the set up for your AWS environment! When you are ready lets begin the next step <a href="../collect-log-cloud-watch/3_send_log_data_to_opensearch.html">Send Log Data to OpenSearch</a></p>





<footer class=" footline" >
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			
		
		
			
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="../js/clipboard.min.js"></script>
    <script src="../js/perfect-scrollbar.min.js"></script>
    <script src="../js/perfect-scrollbar.jquery.min.js"></script>
    <script src="../js/jquery.sticky.js"></script>
    <script src="../js/featherlight.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="../js/modernizr.custom-3.6.0.js"></script>
    <script src="../js/learn.js"></script>
    <script src="../js/hugo-learn.js"></script>
    
        
            <script src="../mermaid/mermaid.js"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>
